#!/usr/bin/env bash
# Fake git command for testing
# Logs all invocations to TEST_CALL_LOG

echo "git $*" >> "${TEST_CALL_LOG:-/dev/null}"

# Default behavior: succeed silently for most operations
case "$1" in
  fetch)
    # Simulate successful fetch
    exit 0
    ;;
  rev-parse)
    # Simulate existence of upstream branch
    if [[ "$2" == "@{u}" ]]; then
      echo "fake-upstream-sha"
      exit 0
    fi
    ;;
  rev-list)
    # Default: report 0 commits behind (up to date)
    # Tests can override by setting GIT_BEHIND_COUNT environment variable
    echo "${GIT_BEHIND_COUNT:-0}"
    exit 0
    ;;
  *)
    # Pass through for other git commands
    exit 0
    ;;
esac
